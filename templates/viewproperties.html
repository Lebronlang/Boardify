{% extends 'base.html' %}

{% block content %}
<div class="properties-page">
    <!-- Enhanced Hero Section with Search -->
    <div class="hero-section">
        <div class="container py-5">
            <div class="row align-items-center g-4">
                <div class="col-lg-7">
                    <div class="hero-content">
                        <h1 class="hero-title">
                            <i class="bi bi-house-heart-fill me-3"></i>
                            Find Your Perfect Home
                        </h1>
                        <p class="hero-subtitle">Discover comfortable living spaces with amazing amenities and trusted landlords</p>
                        
                        <!-- Advanced Search Bar -->
                        <div class="search-bar-wrapper">
                            <div class="search-bar">
                                <i class="bi bi-search search-icon"></i>
                                <input type="text" class="search-input" placeholder="Search by location, title, or price..." id="searchInput">
                                <button class="search-btn" id="advancedFilterBtn">
                                    <i class="bi bi-sliders me-2"></i>Advanced Filters
                                </button>
                                <button class="clear-search-btn" id="clearSearchBtn" style="display: none;">
                                    <i class="bi bi-x-lg"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Quick Stats -->
                        <div class="quick-stats">
                            <div class="stat-badge">
                                <i class="bi bi-building-check"></i>
                                <span><span id="totalPropertiesCount">{{ properties|length }}</span> Properties</span>
                            </div>
                            <div class="stat-badge">
                                <i class="bi bi-people"></i>
                                <span>500+ Happy Tenants</span>
                            </div>
                            <div class="stat-badge">
                                <i class="bi bi-star-fill"></i>
                                <span>4.8 Average Rating</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-5">
                    <!-- Multi-Faceted Filter Panel -->
                    <div class="multi-facet-filter-panel" id="filterPanel">
                        <div class="filter-panel-header">
                            <h5 class="filter-panel-title">
                                <i class="bi bi-funnel-fill me-2"></i>Multi-Facet Filters
                            </h5>
                            <button class="filter-toggle-btn" id="filterToggleBtn">
                                <i class="bi bi-chevron-down"></i>
                            </button>
                        </div>

                        <!-- Active Filters Display -->
                        <div class="active-filters-display" id="activeFiltersDisplay" style="display: none;">
                            <div class="active-filters-header">
                                <span class="active-filters-label">Active Filters:</span>
                                <button class="clear-all-filters" id="clearAllFilters">
                                    <i class="bi bi-x-circle me-1"></i>Clear All
                                </button>
                            </div>
                            <div class="active-filters-list" id="activeFiltersList"></div>
                        </div>

                        <!-- Filter Categories -->
                        <div class="filter-categories" id="filterCategories">
                            <!-- Status Filter -->
                            <div class="filter-category">
                                <div class="filter-category-header" data-category="status">
                                    <h6 class="filter-category-title">
                                        <i class="bi bi-check-circle me-2"></i>Status
                                        <i class="bi bi-chevron-down category-chevron ms-auto"></i>
                                    </h6>
                                </div>
                                <div class="filter-options" data-category-content="status">
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="status" data-filter-value="available">
                                        <span class="filter-option-text">
                                            <i class="bi bi-check-circle-fill text-success me-2"></i>
                                            Available Now
                                        </span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="status" data-filter-value="full">
                                        <span class="filter-option-text">
                                            <i class="bi bi-x-circle-fill text-danger me-2"></i>
                                            Fully Booked
                                        </span>
                                    </label>
                                </div>
                            </div>

                            <!-- Price Range Filter -->
                            <div class="filter-category">
                                <div class="filter-category-header" data-category="price">
                                    <h6 class="filter-category-title">
                                        <i class="bi bi-currency-dollar me-2"></i>Price Range
                                        <i class="bi bi-chevron-down category-chevron ms-auto"></i>
                                    </h6>
                                </div>
                                <div class="filter-options" data-category-content="price">
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="price" data-filter-value="budget">
                                        <span class="filter-option-text">
                                            <i class="bi bi-wallet2 me-2"></i>
                                            Budget (₱0 - ₱3,000)
                                        </span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="price" data-filter-value="mid-range">
                                        <span class="filter-option-text">
                                            <i class="bi bi-cash-stack me-2"></i>
                                            Mid-Range (₱3,001 - ₱6,000)
                                        </span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="price" data-filter-value="premium">
                                        <span class="filter-option-text">
                                            <i class="bi bi-gem me-2"></i>
                                            Premium (₱6,001+)
                                        </span>
                                    </label>
                                </div>
                            </div>

                            <!-- Gender Preference Filter -->
                            <div class="filter-category">
                                <div class="filter-category-header" data-category="gender">
                                    <h6 class="filter-category-title">
                                        <i class="bi bi-gender-ambiguous me-2"></i>Gender Preference
                                        <i class="bi bi-chevron-down category-chevron ms-auto"></i>
                                    </h6>
                                </div>
                                <div class="filter-options" data-category-content="gender">
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="gender" data-filter-value="female">
                                        <span class="filter-option-text">
                                            <i class="bi bi-gender-female text-pink me-2"></i>
                                            Girls Only
                                        </span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="gender" data-filter-value="male">
                                        <span class="filter-option-text">
                                            <i class="bi bi-gender-male text-blue me-2"></i>
                                            Boys Only
                                        </span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="gender" data-filter-value="both">
                                        <span class="filter-option-text">
                                            <i class="bi bi-people-fill text-purple me-2"></i>
                                            Mixed/Gender Neutral
                                        </span>
                                    </label>
                                </div>
                            </div>

                            <!-- Amenities Filter -->
                            <div class="filter-category">
                                <div class="filter-category-header" data-category="amenity">
                                    <h6 class="filter-category-title">
                                        <i class="bi bi-list-check me-2"></i>Amenities
                                        <i class="bi bi-chevron-down category-chevron ms-auto"></i>
                                    </h6>
                                </div>
                                <div class="filter-options" data-category-content="amenity">
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="amenity" data-filter-value="wifi">
                                        <span class="filter-option-text">
                                            <i class="bi bi-wifi me-2"></i>
                                            Free WiFi
                                        </span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="amenity" data-filter-value="ac">
                                        <span class="filter-option-text">
                                            <i class="bi bi-snow me-2"></i>
                                            Air Conditioning
                                        </span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="amenity" data-filter-value="furnished">
                                        <span class="filter-option-text">
                                            <i class="bi bi-house-door me-2"></i>
                                            Fully Furnished
                                        </span>
                                    </label>
                                </div>
                            </div>

                            <!-- Rating Filter -->
                            <div class="filter-category">
                                <div class="filter-category-header" data-category="rating">
                                    <h6 class="filter-category-title">
                                        <i class="bi bi-star-fill me-2"></i>Rating
                                        <i class="bi bi-chevron-down category-chevron ms-auto"></i>
                                    </h6>
                                </div>
                                <div class="filter-options" data-category-content="rating">
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="rating" data-filter-value="high">
                                        <span class="filter-option-text">
                                            <i class="bi bi-star-fill text-warning me-2"></i>
                                            4.5+ Stars
                                        </span>
                                    </label>
                                    <label class="filter-option">
                                        <input type="checkbox" class="filter-checkbox" data-filter-type="rating" data-filter-value="good">
                                        <span class="filter-option-text">
                                            <i class="bi bi-star-half text-warning me-2"></i>
                                            4.0+ Stars
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container py-5">
        <!-- Properties Header with Controls -->
        <div class="properties-header">
            <div class="header-left">
                <h2 class="section-title">
                    {% if user.role == 'landlord' %}
                        <i class="bi bi-building-gear me-2"></i>My Properties
                    {% else %}
                        <i class="bi bi-house-door me-2"></i>Available Properties
                    {% endif %}
                </h2>
                <span class="property-count" id="propertyCount">{{ properties|length }} properties found</span>
            </div>
            
            <div class="header-controls">
                <!-- Sort Dropdown -->
                <div class="sort-dropdown">
                    <select class="form-select sort-select" id="sortSelect">
                        <option value="default">Sort by: Default</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="newest">Newest First</option>
                        <option value="slots">Most Available</option>
                    </select>
                </div>

                <!-- View Toggle -->
                <div class="view-toggle">
                    <button class="view-btn active" data-view="grid" title="Grid View">
                        <i class="bi bi-grid-3x3-gap"></i>
                    </button>
                    <button class="view-btn" data-view="list" title="List View">
                        <i class="bi bi-list-ul"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Properties Grid -->
        <div class="properties-grid" id="propertiesContainer">
            {% if properties %}
                {% for item in properties %}
                <div class="property-card" 
                     data-slots="{{ item.slots_left }}" 
                     data-price="{{ item.property.price }}" 
                     data-status="{{ item.property.status|lower }}"
                     data-gender="{{ item.property.gender_preference|default('both') }}"
                     data-property-id="{{ item.property.id }}"
                     data-available-slots="{{ item.slots_left }}"
                     data-amenities="wifi,ac,furnished"
                     data-rating="4.{{ loop.index % 9 }}">
                    
                    <!-- Property Image Section -->
                    <div class="property-image-wrapper">
                        {% if item.property.image %}
                            <img src="{{ url_for('static', filename='uploads/' + item.property.image) }}" 
                                 class="property-image" 
                                 alt="{{ item.property.title }}" 
                                 loading="lazy">
                        {% else %}
                            <div class="property-image-placeholder">
                                <i class="bi bi-house-door"></i>
                            </div>
                        {% endif %}
                        
                        <!-- Image Overlay with Gradient -->
                        <div class="image-gradient"></div>
                        
                        <!-- Hover Actions -->
                        <div class="hover-actions">
                            <a href="{{ url_for('property_detail', property_id=item.property.id) }}" class="action-btn primary">
                                <i class="bi bi-eye-fill"></i>
                                <span>View Details</span>
                            </a>
                        </div>

                        <!-- Top Badges -->
                        <div class="top-badges">
                            <!-- Status Badge -->
                            {% if item.slots_left > 0 %}
                                <div class="badge-item status-available">
                                    <i class="bi bi-check-circle-fill"></i>
                                    Available
                                </div>
                            {% else %}
                                <div class="badge-item status-full">
                                    <i class="bi bi-x-circle-fill"></i>
                                    Full
                                </div>
                            {% endif %}

                            <!-- Featured Badge (for promoted properties) -->
                            {% if loop.index <= 3 %}
                                <div class="badge-item featured">
                                    <i class="bi bi-star-fill"></i>
                                    Featured
                                </div>
                            {% endif %}
                        </div>

                        <!-- Favorite Button -->
                        {% if session.get('user_role') == 'tenant' %}
                        <button class="favorite-btn" data-property-id="{{ item.property.id }}">
                            <i class="bi bi-heart"></i>
                        </button>
                        {% endif %}

                        <!-- Slots Indicator -->
                        <div class="slots-indicator">
                            <div class="slots-info">
                                <i class="bi bi-people-fill"></i>
                                <span class="slots-text">
                                    {% if item.slots_left > 0 %}
                                        {{ item.slots_left }}/{{ item.total_slots }} Available
                                    {% else %}
                                        Fully Booked
                                    {% endif %}
                                </span>
                            </div>
                            <div class="slots-progress">
                                <div class="slots-progress-bar" data-width="{{ ((item.slots_left / item.total_slots * 100)|round(0, 'floor')|int) if item.total_slots > 0 else 0 }}"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Property Content -->
                    <div class="property-content">
                        <!-- Header -->
                        <div class="content-header">
                            <div class="title-section">
                                <h3 class="property-title">
                                    <a href="{{ url_for('property_detail', property_id=item.property.id) }}">
                                        {{ item.property.title }}
                                    </a>
                                </h3>
                                <div class="property-location">
                                    <i class="bi bi-geo-alt-fill"></i>
                                    <span>{{ item.property.location|default('Location not specified') }}</span>
                                </div>
                            </div>
                            
                            {% if user.role == 'landlord' and item.property.landlord_id == user.id %}
                            <div class="owner-actions">
                                <a href="{{ url_for('edit_property', property_id=item.property.id) }}" 
                                   class="action-icon edit-icon" 
                                   title="Edit Property">
                                    <i class="bi bi-pencil-square"></i>
                                </a>
                                <button class="action-icon delete-icon" 
                                        title="Delete Property"
                                        data-property-id="{{ item.property.id }}"
                                        data-property-title="{{ item.property.title }}">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                            {% endif %}
                        </div>

                        <!-- Property Meta -->
                        <div class="property-meta">
                            <div class="meta-item">
                                <div class="meta-icon">
                                    <i class="bi bi-person-circle"></i>
                                </div>
                                <div class="meta-text">
                                    <span class="meta-label">Hosted by</span>
                                    <span class="meta-value">{{ item.property.owner.name }}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Description -->
                        <p class="property-description">
                            {{ item.property.description[:150] }}{% if item.property.description|length > 150 %}...{% endif %}
                        </p>

                        <!-- Property Features -->
                        <div class="property-features">
                            <div class="feature-item">
                                <i class="bi bi-wifi"></i>
                                <span>Free WiFi</span>
                            </div>
                            <div class="feature-item">
                                <i class="bi bi-snow"></i>
                                <span>AC</span>
                            </div>
                            {% if item.property.gender_preference and item.property.gender_preference != 'both' %}
                            <div class="feature-item gender-feature">
                                <i class="bi bi-{% if item.property.gender_preference == 'female' %}gender-female{% else %}gender-male{% endif %}"></i>
                                <span>{{ 'Girls Only' if item.property.gender_preference == 'female' else 'Boys Only' }}</span>
                            </div>
                            {% endif %}
                            <div class="feature-item">
                                <i class="bi bi-shield-check"></i>
                                <span>Verified</span>
                            </div>
                        </div>

                        <!-- Property Stats -->
                        <div class="property-stats">
                            <div class="stat">
                                <i class="bi bi-calendar-check"></i>
                                <span>{{ item.property.bookings.count() }} Booking{{ 's' if item.property.bookings.count() != 1 else '' }}</span>
                            </div>
                            <div class="stat">
                                <i class="bi bi-star-fill"></i> 
                                <span>4.{{ loop.index % 9 }} Rating</span>
                            </div>
                            <div class="stat">
                                <i class="bi bi-eye"></i>
                                <span>{{ (loop.index * 47) }} Views</span>
                            </div>
                        </div>

                        <!-- Footer -->
                        <div class="property-footer">
                            <div class="price-section">
                                <span class="price-amount">₱{{ "{:,}".format(item.property.price) }}</span>
                                <span class="price-period">/ month</span>
                            </div>

                            <div class="action-section">
                                {% if session.get('user_role') == 'tenant' %}
                                    {% if item.user_has_booked %}
                                        {% set user_booking = item.property.bookings|selectattr('tenant_id', 'equalto', session['user_id'])|first %}
                                        {% if user_booking %}
                                            {% if user_booking.status == 'pending' %}
                                                <button class="btn-action status-pending" disabled>
                                                    <i class="bi bi-clock-history"></i>
                                                    <span>Pending</span>
                                                </button>
                                            {% elif user_booking.status == 'approved' %}
                                                <button class="btn-action status-approved" disabled>
                                                    <i class="bi bi-check-circle-fill"></i>
                                                    <span>Confirmed</span>
                                                </button>
                                            {% elif user_booking.status == 'rejected' %}
                                                <button class="btn-action status-rejected" disabled>
                                                    <i class="bi bi-x-circle-fill"></i>
                                                    <span>Rejected</span>
                                                </button>
                                            {% endif %}
                                        {% endif %}
                                    {% elif item.slots_left > 0 %}
                                        <a href="{{ url_for('property_detail', property_id=item.property.id) }}" class="btn-action primary">
                                            <i class="bi bi-calendar-plus"></i>
                                            <span>Book Now</span>
                                        </a>
                                    {% else %}
                                        <button class="btn-action disabled" disabled>
                                            <i class="bi bi-ban"></i>
                                            <span>Unavailable</span>
                                        </button>
                                    {% endif %}
                                {% elif session.get('user_role') == 'landlord' and item.property.landlord_id == user.id %}
                                    <a href="{{ url_for('edit_property', property_id=item.property.id) }}" class="btn-action secondary">
                                        <i class="bi bi-pencil-square"></i>
                                        <span>Edit</span>
                                    </a>
                                {% else %}
                                    <a href="{{ url_for('property_detail', property_id=item.property.id) }}" class="btn-action outline">
                                        <i class="bi bi-eye"></i>
                                        <span>View</span>
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="bi bi-inbox"></i>
                    </div>
                    <h3>No Properties Found</h3>
                    <p>
                        {% if user.role == 'landlord' %}
                            Start building your property portfolio today!
                        {% else %}
                            Try adjusting your filters or check back later for new listings.
                        {% endif %}
                    </p>
                    {% if user.role == 'landlord' %}
                        <a href="{{ url_for('add_property') }}" class="btn-primary-large">
                            <i class="bi bi-plus-circle me-2"></i>Add Your First Property
                        </a>
                    {% endif %}
                </div>
            {% endif %}
        </div>

        <!-- Pagination -->
        {% if properties|length >= 9 %}
        <div class="pagination-wrapper">
            <button class="pagination-btn" id="prevPage" disabled>
                <i class="bi bi-chevron-left"></i>
                Previous
            </button>
            <div class="pagination-numbers">
                <button class="page-number active">1</button>
                <button class="page-number">2</button>
                <button class="page-number">3</button>
                <span class="page-dots">...</span>
                <button class="page-number">10</button>
            </div>
            <button class="pagination-btn" id="nextPage">
                Next
                <i class="bi bi-chevron-right"></i>
            </button>
        </div>
        {% endif %}
    </div>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="backToTop">
        <i class="bi bi-arrow-up"></i>
    </button>
</div>

<!-- Delete Confirmation Modal -->
<div class="delete-modal-overlay" id="deleteModal">
    <div class="delete-modal">
        <div class="delete-modal-icon">
            <i class="bi bi-exclamation-triangle-fill"></i>
        </div>
        <h3 class="delete-modal-title">Delete Property</h3>
        <p class="delete-modal-message">Are you sure you want to delete this property?</p>
        <div class="delete-modal-property-name" id="deletePropertyName"></div>
        <div class="delete-modal-warning">
            <i class="bi bi-exclamation-circle-fill"></i>
            <div class="delete-modal-warning-text">
                This action cannot be undone. All bookings and data associated with this property will be permanently removed.
            </div>
        </div>
        <div class="delete-modal-actions">
            <button class="delete-modal-btn delete-modal-btn-cancel" id="cancelDelete">
                <i class="bi bi-x-circle me-2"></i>Cancel
            </button>
            <button class="delete-modal-btn delete-modal-btn-confirm" id="confirmDelete" disabled>
                <i class="bi bi-trash-fill me-2"></i>Delete Property
            </button>
        </div>
    </div>
</div>

<style>
    :root {
        /* Facebook Blue Theme */
        --fb-primary: #1877f2;
        --fb-primary-hover: #166fe5;
        --fb-primary-active: #1567d3;
        --fb-secondary: #1877f2;
        --fb-secondary-hover: #166fe5;
        --fb-light-blue: #e7f3ff;
        --fb-lighter-blue: #f0f8ff;
        
        /* Background Colors */
        --bg-primary: #ffffff;
        --bg-secondary: #f0f2f5;
        --bg-tertiary: #e4e6eb;
        --bg-hover: #f2f3f5;
        --bg-card: #ffffff;
        
        /* Text Colors */
        --text-primary: #050505;
        --text-secondary: #65676b;
        --text-tertiary: #8a8d91;
        --text-white: #ffffff;
        
        /* Border & Shadows */
        --border-color: #ced0d4;
        --divider-color: #e4e6eb;
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.12);
        --shadow-xl: 0 8px 24px rgba(0, 0, 0, 0.15);
        --shadow-hover: 0 8px 32px rgba(24, 119, 242, 0.25);
        
        /* Status Colors */
        --success: #1877f2;
        --success-light: #e7f3ff;
        --danger: #e74c3c;
        --danger-light: #fdecea;
        --warning: #f39c12;
        --warning-light: #fef4e6;
        --info: #3498db;
    }

    /* Dark Theme */
    body.dark-theme {
        --bg-primary: #18191a;
        --bg-secondary: #242526;
        --bg-tertiary: #3a3b3c;
        --bg-hover: #4e4f50;
        --bg-card: #242526;
        --text-primary: #e4e6eb;
        --text-secondary: #b0b3b8;
        --text-tertiary: #8a8d91;
        --border-color: #3e4042;
        --divider-color: #3e4042;
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.4);
        --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.4);
        --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.5);
        --shadow-xl: 0 8px 24px rgba(0, 0, 0, 0.6);
        --shadow-hover: 0 8px 32px rgba(24, 119, 242, 0.3);
        --fb-light-blue: rgba(24, 119, 242, 0.15);
        --fb-lighter-blue: rgba(24, 119, 242, 0.1);
        --success-light: rgba(24, 119, 242, 0.15);
        --danger-light: rgba(231, 76, 60, 0.15);
        --warning-light: rgba(243, 156, 18, 0.15);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        background: var(--bg-secondary);
        color: var(--text-primary);
        transition: all 0.3s ease;
    }

    .properties-page {
        min-height: 100vh;
    }

    /* Hero Section */
    .hero-section {
        background: linear-gradient(135deg, var(--fb-primary) 0%, #4a90e2 100%);
        padding: 3rem 0;
        position: relative;
        overflow: hidden;
    }

    .hero-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120"><path fill="rgba(255,255,255,0.05)" d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".25"/></svg>') no-repeat center bottom;
        background-size: cover;
        opacity: 0.3;
    }

    .hero-content {
        position: relative;
        z-index: 2;
    }

    .hero-title {
        font-size: 2.75rem;
        font-weight: 700;
        color: white;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        line-height: 1.2;
    }

    .hero-title i {
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }

    .hero-subtitle {
        font-size: 1.15rem;
        color: rgba(255, 255, 255, 0.95);
        margin-bottom: 2rem;
        font-weight: 400;
    }

    /* Search Bar */
    .search-bar-wrapper {
        margin-bottom: 2rem;
    }

    .search-bar {
        background: white;
        border-radius: 50px;
        padding: 0.5rem 0.5rem 0.5rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        transition: all 0.3s ease;
    }

    .search-bar:focus-within {
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.25);
        transform: translateY(-2px);
    }

    .search-icon {
        color: var(--text-tertiary);
        font-size: 1.2rem;
    }

    .search-input {
        flex: 1;
        border: none;
        outline: none;
        font-size: 1rem;
        color: var(--text-primary);
        background: transparent;
    }

    .search-input::placeholder {
        color: var(--text-tertiary);
    }

    .search-btn {
        background: var(--fb-primary);
        color: white;
        border: none;
        padding: 0.75rem 2rem;
        border-radius: 50px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        white-space: nowrap;
    }

    .search-btn:hover {
        background: var(--fb-primary-hover);
        transform: translateX(-2px);
    }

    .clear-search-btn {
        background: var(--bg-tertiary);
        color: var(--text-secondary);
        border: none;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
    }

    .clear-search-btn:hover {
        background: var(--danger);
        color: white;
        transform: scale(1.1);
    }

    /* Quick Stats */
    .quick-stats {
        display: flex;
        gap: 1.5rem;
        flex-wrap: wrap;
    }

    .stat-badge {
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        padding: 0.75rem 1.25rem;
        border-radius: 50px;
        color: white;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
        font-size: 0.9rem;
        border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .stat-badge i {
        font-size: 1.1rem;
    }

    /* Multi-Faceted Filter Panel - REDESIGNED FOR MOBILE */
    .multi-facet-filter-panel {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(20px);
        border-radius: 16px;
        padding: 1.25rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        max-height: 600px;
        overflow-y: auto;
    }

    /* Custom Scrollbar for Filter Panel */
    .multi-facet-filter-panel::-webkit-scrollbar {
        width: 6px;
    }

    .multi-facet-filter-panel::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
    }

    .multi-facet-filter-panel::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 10px;
    }

    .multi-facet-filter-panel::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
    }

    body.dark-theme .multi-facet-filter-panel {
        background: rgba(0, 0, 0, 0.2);
    }

    .filter-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
        padding-bottom: 0.75rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .filter-panel-title {
        color: white;
        font-weight: 700;
        display: flex;
        align-items: center;
        font-size: 1rem;
        margin: 0;
    }

    .filter-toggle-btn {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        width: 32px;
        height: 32px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .filter-toggle-btn:hover {
        background: rgba(255, 255, 255, 0.3);
    }

    .filter-toggle-btn i {
        transition: transform 0.3s ease;
    }

    .filter-toggle-btn.active i {
        transform: rotate(180deg);
    }

    /* Active Filters Display */
    .active-filters-display {
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        padding: 0.75rem;
        border-radius: 10px;
        margin-bottom: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .active-filters-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
    }

    .active-filters-label {
        color: white;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .clear-all-filters {
        background: rgba(231, 76, 60, 0.9);
        color: white;
        border: none;
        padding: 0.3rem 0.7rem;
        border-radius: 50px;
        font-size: 0.75rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.25rem;
    }

    .clear-all-filters:hover {
        background: rgba(192, 57, 43, 0.9);
        transform: translateY(-1px);
    }

    .active-filters-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.4rem;
    }

    .active-filter-tag {
        background: white;
        color: var(--fb-primary);
        padding: 0.3rem 0.6rem;
        border-radius: 50px;
        font-size: 0.75rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.4rem;
        animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .active-filter-tag i {
        cursor: pointer;
        transition: transform 0.2s ease;
        font-size: 0.85rem;
    }

    .active-filter-tag i:hover {
        transform: scale(1.2);
    }

    /* Filter Categories - COMPACT VERSION */
    .filter-categories {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .filter-category {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 0.75rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
    }

    .filter-category-header {
        margin-bottom: 0.5rem;
        cursor: pointer;
        user-select: none;
    }

    .filter-category-title {
        color: white;
        font-size: 0.85rem;
        font-weight: 700;
        display: flex;
        align-items: center;
        margin: 0;
        transition: all 0.3s ease;
    }

    .category-chevron {
        font-size: 0.8rem;
        transition: transform 0.3s ease;
    }

    .filter-category-header.collapsed + .filter-options {
        max-height: 0;
        overflow: hidden;
        padding: 0;
        margin: 0;
    }

    .filter-category-header.collapsed .category-chevron {
        transform: rotate(-90deg);
    }

    .filter-options {
        display: flex;
        flex-direction: column;
        gap: 0.4rem;
        max-height: 500px;
        overflow: hidden;
        transition: max-height 0.3s ease;
    }

    .filter-option {
        display: flex;
        align-items: center;
        cursor: pointer;
        padding: 0.4rem 0.5rem;
        border-radius: 6px;
        transition: all 0.3s ease;
    }

    .filter-option:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    .filter-checkbox {
        margin-right: 0.6rem;
        width: 14px;
        height: 14px;
        cursor: pointer;
    }

    .filter-option-text {
        color: white;
        font-size: 0.8rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.4rem;
    }

    .filter-option-text i {
        font-size: 0.9rem;
    }

    .text-pink { color: #e91e63; }
    .text-blue { color: #2196f3; }
    .text-purple { color: #9c27b0; }
    .text-warning { color: #ff9800; }
    .text-success { color: #4caf50; }
    .text-danger { color: #f44336; }

    /* Properties Header */
    .properties-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2.5rem;
        flex-wrap: wrap;
        gap: 1.5rem;
    }

    .header-left {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
    }

    .section-title {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        margin: 0;
    }

    .section-title i {
        color: var(--fb-primary);
    }

    .property-count {
        background: var(--fb-light-blue);
        color: var(--fb-primary);
        padding: 0.4rem 1rem;
        border-radius: 50px;
        font-size: 0.9rem;
        font-weight: 600;
    }

    .header-controls {
        display: flex;
        gap: 1rem;
        align-items: center;
    }

    .sort-dropdown {
        position: relative;
    }

    .sort-select {
        background: var(--bg-card);
        border: 2px solid var(--border-color);
        border-radius: 10px;
        padding: 0.6rem 1rem;
        font-weight: 600;
        color: var(--text-primary);
        cursor: pointer;
        transition: all 0.3s ease;
        outline: none;
    }

    .sort-select:hover {
        border-color: var(--fb-primary);
    }

    .sort-select:focus {
        border-color: var(--fb-primary);
        box-shadow: 0 0 0 3px var(--fb-light-blue);
    }

    .view-toggle {
        display: flex;
        gap: 0.5rem;
        background: var(--bg-card);
        padding: 0.35rem;
        border-radius: 10px;
        border: 2px solid var(--border-color);
    }

    .view-btn {
        background: transparent;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1.1rem;
    }

    .view-btn:hover {
        color: var(--fb-primary);
        background: var(--bg-hover);
    }

    .view-btn.active {
        background: var(--fb-primary);
        color: white;
    }

    /* Properties Grid */
    .properties-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
    }

    .properties-grid.list-view {
        grid-template-columns: 1fr;
    }

    .properties-grid.list-view .property-card {
        display: flex;
        flex-direction: row;
    }

    .properties-grid.list-view .property-image-wrapper {
        width: 400px;
        min-width: 400px;
        height: auto;
    }

    .properties-grid.list-view .property-content {
        flex: 1;
    }

    /* Property Card */
    .property-card {
        background: var(--bg-card);
        border-radius: 16px;
        overflow: hidden;
        box-shadow: var(--shadow-md);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border: 2px solid var(--border-color);
        display: flex;
        flex-direction: column;
    }

    .property-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-hover);
        border-color: var(--fb-primary);
    }

    /* Property Image Wrapper */
    .property-image-wrapper {
        position: relative;
        height: 280px;
        overflow: hidden;
        background: var(--bg-tertiary);
    }

    .property-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.6s ease;
    }

    .property-card:hover .property-image {
        transform: scale(1.1);
    }

    .property-image-placeholder {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
        color: var(--text-tertiary);
        font-size: 4rem;
    }

    .image-gradient {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 50%;
        background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
        pointer-events: none;
    }

    /* Hover Actions */
    .hover-actions {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 10;
    }

    .property-card:hover .hover-actions {
        opacity: 1;
    }

    .action-btn {
        background: white;
        color: var(--fb-primary);
        padding: 1rem 2rem;
        border-radius: 50px;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 700;
        font-size: 1.1rem;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        white-space: nowrap;
    }

    .action-btn:hover {
        background: var(--fb-primary);
        color: white;
        transform: scale(1.05);
    }

    /* Top Badges */
    .top-badges {
        position: absolute;
        top: 1rem;
        left: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        z-index: 5;
    }

    .badge-item {
        background: rgba(0, 0, 0, 0.75);
        backdrop-filter: blur(10px);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 50px;
        font-size: 0.85rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    body.dark-theme .badge-item {
        background: rgba(255, 255, 255, 0.15);
    }

    .badge-item.status-available {
        background: rgba(24, 119, 242, 0.95);
        border-color: var(--fb-primary);
    }

    .badge-item.status-full {
        background: rgba(231, 76, 60, 0.95);
        border-color: var(--danger);
    }

    .badge-item.featured {
        background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
        color: #000;
        border-color: #FFD700;
        animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.85; }
    }

    /* Favorite Button */
    .favorite-btn {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: rgba(0, 0, 0, 0.75);
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.2);
        width: 48px;
        height: 48px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.3rem;
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 5;
    }

    body.dark-theme .favorite-btn {
        background: rgba(255, 255, 255, 0.15);
    }

    .favorite-btn:hover {
        background: var(--fb-primary);
        border-color: var(--fb-primary);
        transform: scale(1.1);
    }

    .favorite-btn.active {
        background: var(--danger);
        border-color: var(--danger);
        color: white;
    }

    .favorite-btn.active i::before {
        content: "\f415";
    }

    /* Slots Indicator */
    .slots-indicator {
        position: absolute;
        bottom: 1rem;
        left: 1rem;
        right: 1rem;
        background: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(10px);
        padding: 0.75rem 1rem;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        z-index: 5;
    }

    body.dark-theme .slots-indicator {
        background: rgba(255, 255, 255, 0.15);
    }

    .slots-info {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: white;
        font-weight: 600;
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
    }

    .slots-info i {
        font-size: 1.1rem;
    }

    .slots-progress {
        height: 6px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 3px;
        overflow: hidden;
    }

    .slots-progress-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--fb-primary) 0%, #4a90e2 100%);
        border-radius: 3px;
        transition: width 0.5s ease;
    }

    /* Property Content */
    .property-content {
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        flex: 1;
    }

    .content-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1rem;
        gap: 1rem;
    }

    .title-section {
        flex: 1;
    }

    .property-title {
        font-size: 1.35rem;
        font-weight: 700;
        color: var(--text-primary);
        margin: 0 0 0.5rem 0;
        line-height: 1.3;
    }

    .property-title a {
        color: inherit;
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .property-title a:hover {
        color: var(--fb-primary);
    }

    .property-location {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .property-location i {
        color: var(--fb-primary);
    }

    /* Enhanced Owner Actions for Landlords */
    .owner-actions {
        display: flex;
        gap: 0.5rem;
    }

    .action-icon {
        background: var(--bg-hover);
        border: 2px solid var(--border-color);
        color: var(--text-secondary);
        width: 36px;
        height: 36px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
    }

    .action-icon:hover {
        transform: scale(1.05);
    }

    .action-icon.edit-icon:hover {
        background: var(--fb-light-blue);
        border-color: var(--fb-primary);
        color: var(--fb-primary);
    }

    .action-icon.delete-icon:hover {
        background: var(--danger-light);
        border-color: var(--danger);
        color: var(--danger);
    }

    /* Property Meta */
    .property-meta {
        margin-bottom: 1rem;
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem;
        background: var(--bg-secondary);
        border-radius: 10px;
        border: 1px solid var(--border-color);
    }

    .meta-icon {
        width: 40px;
        height: 40px;
        background: var(--fb-light-blue);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--fb-primary);
        font-size: 1.2rem;
    }

    .meta-text {
        display: flex;
        flex-direction: column;
    }

    .meta-label {
        font-size: 0.8rem;
        color: var(--text-tertiary);
        font-weight: 500;
    }

    .meta-value {
        font-size: 0.95rem;
        color: var(--text-primary);
        font-weight: 600;
    }

    /* Property Description */
    .property-description {
        color: var(--text-secondary);
        font-size: 0.95rem;
        line-height: 1.6;
        margin-bottom: 1rem;
    }

    /* Property Features */
    .property-features {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-bottom: 1rem;
    }

    .feature-item {
        background: var(--bg-secondary);
        padding: 0.5rem 1rem;
        border-radius: 50px;
        font-size: 0.85rem;
        font-weight: 600;
        color: var(--text-secondary);
        display: flex;
        align-items: center;
        gap: 0.5rem;
        border: 1px solid var(--border-color);
        transition: all 0.3s ease;
    }

    .feature-item:hover {
        background: var(--fb-light-blue);
        color: var(--fb-primary);
        border-color: var(--fb-primary);
    }

    .feature-item i {
        font-size: 1rem;
    }

    .feature-item.gender-feature {
        background: var(--fb-light-blue);
        color: var(--fb-primary);
        border-color: var(--fb-primary);
    }

    /* Property Stats */
    .property-stats {
        display: flex;
        gap: 1.5rem;
        padding: 1rem 0;
        border-top: 1px solid var(--divider-color);
        border-bottom: 1px solid var(--divider-color);
        margin-bottom: 1rem;
    }

    .stat {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-secondary);
        font-size: 0.9rem;
        font-weight: 600;
    }

    .stat i {
        color: var(--fb-primary);
        font-size: 1rem;
    }

    /* Property Footer */
    .property-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: auto;
        gap: 1rem;
    }

    .price-section {
        display: flex;
        flex-direction: column;
    }

    .price-amount {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--fb-primary);
        line-height: 1;
    }

    .price-period {
        font-size: 0.85rem;
        color: var(--text-tertiary);
        font-weight: 500;
    }

    .action-section {
        flex-shrink: 0;
    }

    .btn-action {
        padding: 0.75rem 1.5rem;
        border-radius: 10px;
        font-weight: 700;
        font-size: 0.95rem;
        border: 2px solid transparent;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        text-decoration: none;
        white-space: nowrap;
    }

    .btn-action.primary {
        background: var(--fb-primary);
        color: white;
    }

    .btn-action.primary:hover {
        background: var(--fb-primary-hover);
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
    }

    .btn-action.secondary {
        background: var(--fb-primary);
        color: white;
    }

    .btn-action.secondary:hover {
        background: var(--fb-primary-hover);
        transform: translateY(-2px);
    }

    .btn-action.outline {
        background: transparent;
        border-color: var(--border-color);
        color: var(--text-primary);
    }

    .btn-action.outline:hover {
        border-color: var(--fb-primary);
        color: var(--fb-primary);
        background: var(--fb-light-blue);
    }

    .btn-action.status-pending {
        background: var(--warning-light);
        color: var(--warning);
        border-color: var(--warning);
        cursor: not-allowed;
    }

    .btn-action.status-approved {
        background: var(--success-light);
        color: var(--success);
        border-color: var(--success);
        cursor: not-allowed;
    }

    .btn-action.status-rejected {
        background: var(--danger-light);
        color: var(--danger);
        border-color: var(--danger);
        cursor: not-allowed;
    }

    .btn-action.disabled {
        background: var(--bg-tertiary);
        color: var(--text-tertiary);
        border-color: var(--border-color);
        cursor: not-allowed;
        opacity: 0.6;
    }

    /* Delete Confirmation Modal */
    .delete-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.75);
        backdrop-filter: blur(4px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
    }

    .delete-modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    .delete-modal {
        background: var(--bg-card);
        border-radius: 20px;
        padding: 2rem;
        max-width: 500px;
        width: 90%;
        box-shadow: var(--shadow-xl);
        transform: scale(0.9);
        transition: transform 0.3s ease;
    }

    .delete-modal-overlay.active .delete-modal {
        transform: scale(1);
    }

    .delete-modal-icon {
        width: 80px;
        height: 80px;
        background: var(--danger-light);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1.5rem;
        color: var(--danger);
        font-size: 2.5rem;
        animation: shake 0.5s ease;
    }

    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        75% { transform: translateX(10px); }
    }

    .delete-modal-title {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--text-primary);
        text-align: center;
        margin-bottom: 0.75rem;
    }

    .delete-modal-message {
        font-size: 1rem;
        color: var(--text-secondary);
        text-align: center;
        margin-bottom: 0.5rem;
        line-height: 1.6;
    }

    .delete-modal-property-name {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--fb-primary);
        text-align: center;
        margin-bottom: 2rem;
        padding: 1rem;
        background: var(--fb-light-blue);
        border-radius: 12px;
    }

    .delete-modal-warning {
        background: var(--warning-light);
        border: 2px solid var(--warning);
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 2rem;
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
    }

    .delete-modal-warning i {
        color: var(--warning);
        font-size: 1.5rem;
        flex-shrink: 0;
    }

    .delete-modal-warning-text {
        color: var(--text-primary);
        font-size: 0.9rem;
        font-weight: 600;
        line-height: 1.5;
    }

    .delete-modal-actions {
        display: flex;
        gap: 1rem;
    }

    .delete-modal-btn {
        flex: 1;
        padding: 1rem 1.5rem;
        border-radius: 12px;
        font-weight: 700;
        font-size: 1rem;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
    }

    .delete-modal-btn-cancel {
        background: var(--bg-tertiary);
        color: var(--text-primary);
        border: 2px solid var(--border-color);
    }

    .delete-modal-btn-cancel:hover {
        background: var(--bg-hover);
        border-color: var(--text-secondary);
    }

    .delete-modal-btn-confirm {
        background: var(--danger);
        color: white;
    }

    .delete-modal-btn-confirm:hover {
        background: #c0392b;
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
    }

    .delete-modal-btn-confirm:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }

    /* Success Delete Animation */
    @keyframes deleteSuccess {
        0% {
            opacity: 1;
            transform: scale(1);
        }
        50% {
            opacity: 0.5;
            transform: scale(0.9) rotateZ(-5deg);
        }
        100% {
            opacity: 0;
            transform: scale(0.8) rotateZ(-10deg);
        }
    }

    .property-card.deleting {
        animation: deleteSuccess 0.5s ease forwards;
        pointer-events: none;
    }

    /* Empty State */
    .empty-state {
        grid-column: 1 / -1;
        text-align: center;
        padding: 5rem 2rem;
    }

    .empty-icon {
        width: 120px;
        height: 120px;
        background: var(--fb-light-blue);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 2rem;
        color: var(--fb-primary);
    }

    .empty-icon i {
        font-size: 4rem;
    }

    .empty-state h3 {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 1rem;
    }

    .empty-state p {
        font-size: 1.1rem;
        color: var(--text-secondary);
        margin-bottom: 2rem;
        max-width: 500px;
        margin-left: auto;
        margin-right: auto;
    }

    .btn-primary-large {
        background: var(--fb-primary);
        color: white;
        padding: 1rem 2.5rem;
        border-radius: 50px;
        font-weight: 700;
        font-size: 1.1rem;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        transition: all 0.3s ease;
        border: none;
    }

    .btn-primary-large:hover {
        background: var(--fb-primary-hover);
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
        color: white;
    }

    /* Pagination */
    .pagination-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 1rem;
        margin-top: 3rem;
    }

    .pagination-btn {
        background: var(--bg-card);
        border: 2px solid var(--border-color);
        color: var(--text-primary);
        padding: 0.75rem 1.5rem;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .pagination-btn:hover:not(:disabled) {
        background: var(--fb-primary);
        border-color: var(--fb-primary);
        color: white;
    }

    .pagination-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .pagination-numbers {
        display: flex;
        gap: 0.5rem;
        align-items: center;
    }

    .page-number {
        background: var(--bg-card);
        border: 2px solid var(--border-color);
        color: var(--text-primary);
        width: 40px;
        height: 40px;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .page-number:hover {
        background: var(--fb-light-blue);
        border-color: var(--fb-primary);
        color: var(--fb-primary);
    }

    .page-number.active {
        background: var(--fb-primary);
        border-color: var(--fb-primary);
        color: white;
    }

    .page-dots {
        color: var(--text-tertiary);
        font-weight: 700;
    }

    /* Back to Top Button */
    .back-to-top {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        background: var(--fb-primary);
        color: white;
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s ease;
        opacity: 0;
        visibility: hidden;
        z-index: 1000;
        box-shadow: var(--shadow-lg);
    }

    .back-to-top.visible {
        opacity: 1;
        visibility: visible;
    }

    .back-to-top:hover {
        background: var(--fb-primary-hover);
        transform: translateY(-3px);
        box-shadow: var(--shadow-xl);
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
        .properties-grid {
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        }
    }

    @media (max-width: 992px) {
        .hero-title {
            font-size: 2.25rem;
        }
        
        .properties-header {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .header-controls {
            width: 100%;
            justify-content: space-between;
        }

        .multi-facet-filter-panel {
            max-height: 450px;
            padding: 1rem;
        }

        .filter-panel-title {
            font-size: 0.9rem;
        }
    }

    @media (max-width: 768px) {
        .hero-section {
            padding: 2rem 0;
        }
        
        .hero-title {
            font-size: 1.75rem;
        }

        .hero-subtitle {
            font-size: 1rem;
        }
        
        .search-bar {
            flex-direction: column;
            border-radius: 16px;
            padding: 1rem;
            gap: 0.75rem;
        }
        
        .search-input {
            width: 100%;
        }

        .search-btn {
            width: 100%;
            justify-content: center;
            padding: 0.75rem 1.5rem;
        }

        .search-btn span {
            display: inline;
        }
        
        .properties-grid {
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        
        .properties-grid.list-view .property-card {
            flex-direction: column;
        }
        
        .properties-grid.list-view .property-image-wrapper {
            width: 100%;
            min-width: auto;
        }
        
        .quick-stats {
            justify-content: center;
            gap: 0.75rem;
        }
        
        .stat-badge {
            flex: 1;
            min-width: 100px;
            justify-content: center;
            padding: 0.6rem 0.9rem;
            font-size: 0.8rem;
        }

        /* Mobile Filter Panel Adjustments */
        .multi-facet-filter-panel {
            max-height: 400px;
            padding: 0.9rem;
        }

        .filter-categories {
            gap: 0.6rem;
        }

        .filter-category {
            padding: 0.6rem;
        }

        .filter-category-title {
            font-size: 0.8rem;
        }

        .filter-option {
            padding: 0.35rem 0.4rem;
        }

        .filter-option-text {
            font-size: 0.75rem;
        }

        .active-filters-display {
            padding: 0.6rem;
        }

        .active-filter-tag {
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
        }

        /* Collapsible filters by default on mobile */
        .filter-categories {
            display: block;
        }

        .filter-category-header:not(.expanded) + .filter-options {
            max-height: 0;
            padding: 0;
            margin: 0;
        }

        .filter-category-header:not(.expanded) .category-chevron {
            transform: rotate(-90deg);
        }

        .section-title {
            font-size: 1.5rem;
        }

        .property-count {
            font-size: 0.85rem;
            padding: 0.35rem 0.85rem;
        }

        .property-image-wrapper {
            height: 240px;
        }

        .property-stats {
            gap: 1rem;
            flex-wrap: wrap;
        }

        .stat {
            font-size: 0.85rem;
        }

        .pagination-numbers {
            gap: 0.35rem;
        }

        .page-number {
            width: 36px;
            height: 36px;
            font-size: 0.9rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            font-size: 0.9rem;
        }
    }

    @media (max-width: 576px) {
        .hero-title {
            font-size: 1.5rem;
            flex-direction: column;
            align-items: flex-start;
        }

        .hero-title i {
            margin-bottom: 0.5rem;
        }

        .hero-subtitle {
            font-size: 0.95rem;
        }

        .search-bar {
            padding: 0.85rem;
        }

        .search-btn {
            padding: 0.65rem 1.25rem;
            font-size: 0.9rem;
        }

        .quick-stats {
            flex-direction: column;
            gap: 0.6rem;
        }

        .stat-badge {
            width: 100%;
            min-width: auto;
        }

        /* Ultra compact filter panel for small phones */
        .multi-facet-filter-panel {
            max-height: 350px;
            padding: 0.75rem;
        }

        .filter-panel-header {
            margin-bottom: 0.75rem;
            padding-bottom: 0.6rem;
        }

        .filter-panel-title {
            font-size: 0.85rem;
        }

        .filter-toggle-btn {
            width: 28px;
            height: 28px;
        }

        .filter-category {
            padding: 0.5rem;
        }

        .filter-option {
            padding: 0.3rem 0.35rem;
        }

        .filter-checkbox {
            width: 12px;
            height: 12px;
            margin-right: 0.5rem;
        }

        .filter-option-text {
            font-size: 0.7rem;
        }

        .filter-option-text i {
            font-size: 0.8rem;
        }

        .active-filters-label {
            font-size: 0.7rem;
        }

        .clear-all-filters {
            font-size: 0.7rem;
            padding: 0.25rem 0.6rem;
        }
        
        .property-footer {
            flex-direction: column;
            align-items: flex-start;
            gap: 1rem;
        }
        
        .action-section {
            width: 100%;
        }
        
        .btn-action {
            width: 100%;
            justify-content: center;
        }
        
        .delete-modal {
            padding: 1.5rem;
        }

        .delete-modal-icon {
            width: 60px;
            height: 60px;
            font-size: 2rem;
        }

        .delete-modal-title {
            font-size: 1.4rem;
        }

        .delete-modal-actions {
            flex-direction: column;
        }

        .delete-modal-btn {
            padding: 0.85rem 1.25rem;
        }

        .header-controls {
            flex-direction: column;
            gap: 0.75rem;
        }

        .sort-dropdown,
        .view-toggle {
            width: 100%;
        }

        .sort-select {
            width: 100%;
        }

        .view-toggle {
            justify-content: center;
        }

        .back-to-top {
            bottom: 1rem;
            right: 1rem;
            width: 45px;
            height: 45px;
        }
    }

    @media (max-width: 400px) {
        .hero-title {
            font-size: 1.35rem;
        }

        .multi-facet-filter-panel {
            max-height: 300px;
        }

        .filter-panel-title i {
            display: none;
        }

        .property-title {
            font-size: 1.15rem;
        }

        .price-amount {
            font-size: 1.5rem;
        }
    }

    /* Success Delete Animation */
@keyframes deleteSuccess {
    0% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.5;
        transform: scale(0.9) rotateZ(-5deg);
    }
    100% {
        opacity: 0;
        transform: scale(0.8) rotateZ(-10deg);
    }
}

.property-card.deleting {
    animation: deleteSuccess 0.5s ease forwards;
    pointer-events: none;
}

/* Toast notifications */
.custom-toast {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 9999;
    display: flex;
    align-items: center;
    font-weight: 600;
    font-size: 0.95rem;
    animation: slideInRight 0.3s ease-out;
}

@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.toast-success {
    background: #28a745;
    color: white;
}

.toast-danger {
    background: #dc3545;
    color: white;
}

.toast-warning {
    background: #ffc107;
    color: black;
}

.toast-info {
    background: #007bff;
    color: white;
}
</style>

<script>


    // Property deletion functionality
function deleteProperty(propertyId) {
    if (!confirm('Are you sure you want to delete this property? This action cannot be undone.')) {
        return;
    }

    fetch(`/delete-property/${propertyId}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'X-Requested-With': 'XMLHttpRequest'
        },
        credentials: 'same-origin'
    })
    .then(response => response.json())
    .then(data => handleDeleteResponse(data, propertyId))
    .catch(error => {
        console.error('Error deleting property:', error);
        showToast('Error deleting property. Please try again.', 'danger');
    });
}

function handleDeleteResponse(response, propertyId) {
    if (response.success === false) {
        if (response.message.includes('not found') || response.message.includes('already deleted')) {
            // Property already deleted - remove it from the UI
            showToast('Property was already deleted', 'info');
            // Remove the property card from DOM
            const propertyCard = document.querySelector(`[data-property-id="${propertyId}"]`);
            if (propertyCard) {
                propertyCard.remove();
                updatePropertyCount(); // Update count after removal
            }
        } else {
            showToast(response.message, 'danger');
        }
    } else {
        showToast('Property deleted successfully!', 'success');
        // Remove the property card from DOM
        const propertyCard = document.querySelector(`[data-property-id="${propertyId}"]`);
        if (propertyCard) {
            propertyCard.remove();
        }
        // Update property count
        updatePropertyCount(response.new_count);
    }
}

function updatePropertyCount(newCount = null) {
    const countElement = document.getElementById('propertyCount');
    const totalCountElement = document.getElementById('totalPropertiesCount');
    const emptyState = document.querySelector('.empty-state');
    const propertiesGrid = document.querySelector('.properties-grid');
    
    if (countElement) {
        if (newCount !== null) {
            countElement.textContent = `${newCount} properties found`;
        } else {
            // Recalculate count from remaining properties
            const remainingProperties = document.querySelectorAll('.property-card[data-property-id]').length;
            countElement.textContent = `${remainingProperties} properties found`;
        }
    }
    
    if (totalCountElement) {
        const currentCount = newCount !== null ? newCount : document.querySelectorAll('.property-card[data-property-id]').length;
        totalCountElement.textContent = currentCount;
    }
    
    // Show/hide empty state
    const currentCount = newCount !== null ? newCount : document.querySelectorAll('.property-card[data-property-id]').length;
    
    if (emptyState && propertiesGrid) {
        if (currentCount === 0) {
            emptyState.style.display = 'block';
            propertiesGrid.style.display = 'none';
        } else {
            emptyState.style.display = 'none';
            propertiesGrid.style.display = 'grid';
        }
    }
}

// Toast notification function
function showToast(message, type = 'info') {
    // Remove existing toasts
    const existingToasts = document.querySelectorAll('.custom-toast');
    existingToasts.forEach(toast => toast.remove());
    
    const toast = document.createElement('div');
    toast.className = `custom-toast toast-${type}`;
    
    const icons = {
        success: 'check-circle-fill',
        danger: 'x-circle-fill',
        warning: 'exclamation-circle-fill',
        info: 'info-circle-fill'
    };
    
    toast.innerHTML = `
        <i class="bi bi-${icons[type] || 'info-circle-fill'} me-2"></i>
        <span>${message}</span>
    `;
    
    Object.assign(toast.style, {
        position: 'fixed',
        top: '20px',
        right: '20px',
        background: type === 'success' ? '#28a745' : 
                   type === 'danger' ? '#dc3545' : 
                   type === 'warning' ? '#ffc107' : '#007bff',
        color: 'white',
        padding: '1rem 1.5rem',
        borderRadius: '8px',
        boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',
        zIndex: '9999',
        display: 'flex',
        alignItems: 'center',
        fontWeight: '600',
        fontSize: '0.95rem'
    });
    
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.remove();
    }, 4000);
}
    document.addEventListener('DOMContentLoaded', function() {
        // Multi-Faceted Filter System
        class MultiFacetFilter {
            constructor() {
                this.activeFilters = new Map();
                this.properties = Array.from(document.querySelectorAll('.property-card'));
                this.searchInput = document.getElementById('searchInput');
                this.sortSelect = document.getElementById('sortSelect');
                this.clearSearchBtn = document.getElementById('clearSearchBtn');
                this.clearAllFiltersBtn = document.getElementById('clearAllFilters');
                this.activeFiltersDisplay = document.getElementById('activeFiltersDisplay');
                this.activeFiltersList = document.getElementById('activeFiltersList');
                this.propertyCount = document.getElementById('propertyCount');
                this.totalPropertiesCount = document.getElementById('totalPropertiesCount');
                
                this.init();
            }

            init() {
                this.bindEvents();
                this.updatePropertyCount();
                this.initializeCollapsibleCategories();
            }


            

            initializeCollapsibleCategories() {
                // Collapse all categories by default on mobile
                const isMobile = window.innerWidth <= 768;
                
                document.querySelectorAll('.filter-category-header').forEach(header => {
                    header.addEventListener('click', (e) => {
                        e.preventDefault();
                        header.classList.toggle('expanded');
                        header.classList.toggle('collapsed');
                    });

                    // Set initial state
                    if (isMobile) {
                        header.classList.add('collapsed');
                    } else {
                        header.classList.add('expanded');
                    }
                });
            }

            bindEvents() {
                // Filter checkbox events
                document.querySelectorAll('.filter-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => this.handleFilterChange(e));
                });

                // Search input events
                this.searchInput.addEventListener('input', (e) => this.handleSearch(e));
                this.clearSearchBtn.addEventListener('click', () => this.clearSearch());

                // Sort events
                this.sortSelect.addEventListener('change', (e) => this.handleSort(e));

                // Clear all filters
                this.clearAllFiltersBtn.addEventListener('click', () => this.clearAllFilters());

                // Filter toggle for mobile
                const filterToggleBtn = document.getElementById('filterToggleBtn');
                const filterCategories = document.getElementById('filterCategories');
                
                if (filterToggleBtn) {
                    filterToggleBtn.addEventListener('click', () => {
                        if (filterCategories.style.display === 'none') {
                            filterCategories.style.display = 'flex';
                            filterToggleBtn.classList.add('active');
                        } else {
                            filterCategories.style.display = 'none';
                            filterToggleBtn.classList.remove('active');
                        }
                    });

                    // Start with filters visible on desktop, hidden on mobile
                    if (window.innerWidth <= 768) {
                        filterCategories.style.display = 'none';
                    }
                }

                // Handle window resize
                window.addEventListener('resize', () => {
                    const filterCategories = document.getElementById('filterCategories');
                    if (window.innerWidth > 768 && filterCategories) {
                        filterCategories.style.display = 'flex';
                    }
                });
            }

            handleFilterChange(event) {
                const checkbox = event.target;
                const filterType = checkbox.dataset.filterType;
                const filterValue = checkbox.dataset.filterValue;
                const isChecked = checkbox.checked;

                if (isChecked) {
                    this.addFilter(filterType, filterValue);
                } else {
                    this.removeFilter(filterType, filterValue);
                }

                this.applyFilters();
            }

            addFilter(type, value) {
                if (!this.activeFilters.has(type)) {
                    this.activeFilters.set(type, new Set());
                }
                this.activeFilters.get(type).add(value);
                this.updateActiveFiltersDisplay();
            }

            removeFilter(type, value) {
                if (this.activeFilters.has(type)) {
                    this.activeFilters.get(type).delete(value);
                    if (this.activeFilters.get(type).size === 0) {
                        this.activeFilters.delete(type);
                    }
                }
                this.updateActiveFiltersDisplay();
            }

            updateActiveFiltersDisplay() {
                // Clear current display
                this.activeFiltersList.innerHTML = '';

                if (this.activeFilters.size === 0) {
                    this.activeFiltersDisplay.style.display = 'none';
                    return;
                }

                this.activeFiltersDisplay.style.display = 'block';

                // Add active filter tags
                for (const [type, values] of this.activeFilters) {
                    for (const value of values) {
                        const filterTag = this.createFilterTag(type, value);
                        this.activeFiltersList.appendChild(filterTag);
                    }
                }
            }

            createFilterTag(type, value) {
                const tag = document.createElement('div');
                tag.className = 'active-filter-tag';
                
                const displayText = this.getFilterDisplayText(type, value);
                tag.innerHTML = `
                    ${displayText}
                    <i class="bi bi-x" data-filter-type="${type}" data-filter-value="${value}"></i>
                `;

                // Add remove event
                tag.querySelector('i').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.removeFilter(type, value);
                    this.uncheckCorrespondingCheckbox(type, value);
                    this.applyFilters();
                });

                return tag;
            }

            getFilterDisplayText(type, value) {
                const displayTexts = {
                    status: {
                        available: 'Available Now',
                        full: 'Fully Booked'
                    },
                    price: {
                        budget: 'Budget (₱0-₱3,000)',
                        'mid-range': 'Mid-Range (₱3,001-₱6,000)',
                        premium: 'Premium (₱6,001+)'
                    },
                    gender: {
                        female: 'Girls Only',
                        male: 'Boys Only',
                        both: 'Mixed/Gender Neutral'
                    },
                    amenity: {
                        wifi: 'Free WiFi',
                        ac: 'Air Conditioning',
                        furnished: 'Fully Furnished'
                    },
                    rating: {
                        high: '4.5+ Stars',
                        good: '4.0+ Stars'
                    }
                };

                return displayTexts[type]?.[value] || value;
            }

            uncheckCorrespondingCheckbox(type, value) {
                const checkbox = document.querySelector(
                    `.filter-checkbox[data-filter-type="${type}"][data-filter-value="${value}"]`
                );
                if (checkbox) {
                    checkbox.checked = false;
                }
            }

            handleSearch(event) {
                const searchTerm = event.target.value.toLowerCase().trim();
                
                if (searchTerm) {
                    this.clearSearchBtn.style.display = 'flex';
                } else {
                    this.clearSearchBtn.style.display = 'none';
                }

                this.applyFilters();
            }

            clearSearch() {
                this.searchInput.value = '';
                this.clearSearchBtn.style.display = 'none';
                this.applyFilters();
            }

            handleSort(event) {
                this.applyFilters();
            }

            clearAllFilters() {
                // Clear active filters
                this.activeFilters.clear();
                
                // Uncheck all checkboxes
                document.querySelectorAll('.filter-checkbox').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // Clear search
                this.clearSearch();
                
                // Update display
                this.updateActiveFiltersDisplay();
                this.applyFilters();
            }

            applyFilters() {
                const searchTerm = this.searchInput.value.toLowerCase().trim();
                const sortValue = this.sortSelect.value;
                
                let visibleCount = 0;

                this.properties.forEach(property => {
                    let matchesSearch = true;
                    let matchesFilters = true;

                    // Apply search filter
                    if (searchTerm) {
                        const title = property.querySelector('.property-title').textContent.toLowerCase();
                        const location = property.querySelector('.property-location span').textContent.toLowerCase();
                        const price = property.querySelector('.price-amount').textContent.toLowerCase();
                        
                        matchesSearch = title.includes(searchTerm) || 
                                       location.includes(searchTerm) || 
                                       price.includes(searchTerm);
                    }

                    // Apply multi-facet filters
                    if (this.activeFilters.size > 0) {
                        matchesFilters = this.matchesAllFilters(property);
                    }

                    // Show/hide property based on filters
                    if (matchesSearch && matchesFilters) {
                        property.style.display = 'flex';
                        visibleCount++;
                    } else {
                        property.style.display = 'none';
                    }
                });

                // Apply sorting
                this.sortProperties(sortValue);

                // Update counters
                this.updatePropertyCount(visibleCount);
            }

            matchesAllFilters(property) {
                for (const [type, values] of this.activeFilters) {
                    let matchesThisType = false;

                    for (const value of values) {
                        if (this.matchesFilter(property, type, value)) {
                            matchesThisType = true;
                            break;
                        }
                    }

                    if (!matchesThisType) {
                        return false;
                    }
                }

                return true;
            }

            matchesFilter(property, type, value) {
                const propertyData = {
                    slots: parseInt(property.dataset.slots),
                    price: parseInt(property.dataset.price),
                    status: property.dataset.status,
                    gender: property.dataset.gender,
                    amenities: property.dataset.amenities?.split(','),
                    rating: parseFloat(property.dataset.rating)
                };

                switch (type) {
                    case 'status':
                        if (value === 'available') {
                            return propertyData.slots > 0;
                        } else if (value === 'full') {
                            return propertyData.slots === 0;
                        }
                        break;

                    case 'price':
                        if (value === 'budget') {
                            return propertyData.price <= 3000;
                        } else if (value === 'mid-range') {
                            return propertyData.price > 3000 && propertyData.price <= 6000;
                        } else if (value === 'premium') {
                            return propertyData.price > 6000;
                        }
                        break;

                    case 'gender':
                        return propertyData.gender === value;

                    case 'amenity':
                        return propertyData.amenities?.includes(value);

                    case 'rating':
                        if (value === 'high') {
                            return propertyData.rating >= 4.5;
                        } else if (value === 'good') {
                            return propertyData.rating >= 4.0;
                        }
                        break;
                }

                return false;
            }

            sortProperties(sortValue) {
                const container = document.getElementById('propertiesContainer');
                const visibleProperties = Array.from(this.properties).filter(p => p.style.display !== 'none');

                visibleProperties.sort((a, b) => {
                    const aData = {
                        price: parseInt(a.dataset.price),
                        slots: parseInt(a.dataset.slots),
                        id: parseInt(a.dataset.propertyId)
                    };
                    const bData = {
                        price: parseInt(b.dataset.price),
                        slots: parseInt(b.dataset.slots),
                        id: parseInt(b.dataset.propertyId)
                    };

                    switch (sortValue) {
                        case 'price-low':
                            return aData.price - bData.price;
                        case 'price-high':
                            return bData.price - aData.price;
                        case 'newest':
                            return bData.id - aData.id;
                        case 'slots':
                            return bData.slots - aData.slots;
                        default:
                            return 0;
                    }
                });

                // Reorder properties in DOM
                visibleProperties.forEach(property => {
                    container.appendChild(property);
                });
            }

            updatePropertyCount(visibleCount = null) {
                const totalCount = this.properties.length;
                const currentCount = visibleCount !== null ? visibleCount : totalCount;
                
                // Update the main property count below the header
                this.propertyCount.textContent = `${currentCount} ${currentCount === 1 ? 'property' : 'properties'} found`;
                
                // Update the total properties count in the hero section (stat badge)
                this.totalPropertiesCount.textContent = currentCount;
            }
        }

        // Initialize the multi-facet filter system
        const filterSystem = new MultiFacetFilter();

        // View Toggle Functionality
        const viewButtons = document.querySelectorAll('.view-btn');
        const propertiesContainer = document.getElementById('propertiesContainer');

        viewButtons.forEach(button => {
            button.addEventListener('click', () => {
                const view = button.dataset.view;
                
                // Update active button
                viewButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // Update view
                propertiesContainer.className = 'properties-grid';
                if (view === 'list') {
                    propertiesContainer.classList.add('list-view');
                }
            });
        });

        // Back to Top Functionality
        const backToTopBtn = document.getElementById('backToTop');

        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTopBtn.classList.add('visible');
            } else {
                backToTopBtn.classList.remove('visible');
            }
        });

        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Delete Property Functionality
const deleteModal = document.getElementById('deleteModal');
const cancelDeleteBtn = document.getElementById('cancelDelete');
const confirmDeleteBtn = document.getElementById('confirmDelete');
const deletePropertyName = document.getElementById('deletePropertyName');

let currentDeleteProperty = null;

document.querySelectorAll('.delete-icon').forEach(button => {
    button.addEventListener('click', (e) => {
        e.preventDefault();
        currentDeleteProperty = {
            id: button.dataset.propertyId,
            title: button.dataset.propertyTitle
        };
        
        deletePropertyName.textContent = currentDeleteProperty.title;
        deleteModal.classList.add('active');
        confirmDeleteBtn.disabled = true;
        
        // Enable delete button after 2 seconds (safety measure)
        setTimeout(() => {
            confirmDeleteBtn.disabled = false;
        }, 2000);
    });
});

cancelDeleteBtn.addEventListener('click', () => {
    deleteModal.classList.remove('active');
    currentDeleteProperty = null;
});

confirmDeleteBtn.addEventListener('click', () => {
    if (currentDeleteProperty && !confirmDeleteBtn.disabled) {
        // Find and animate the property card
        const propertyCard = document.querySelector(`[data-property-id="${currentDeleteProperty.id}"]`);
        if (propertyCard) {
            propertyCard.classList.add('deleting');
            
            // Show loading state on button
            confirmDeleteBtn.disabled = true;
            confirmDeleteBtn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Deleting...';
            
            // Call the actual delete function
            deleteProperty(currentDeleteProperty.id);
            
            // Close modal after a short delay
            setTimeout(() => {
                deleteModal.classList.remove('active');
                // Reset button state
                confirmDeleteBtn.disabled = false;
                confirmDeleteBtn.innerHTML = '<i class="bi bi-trash-fill me-2"></i>Delete Property';
                currentDeleteProperty = null;
            }, 1000);
        }
    }
});

// Initialize delete buttons when page loads
document.addEventListener('DOMContentLoaded', function() {
    // Your existing code...
    
    // Add event listeners to all delete buttons
    const deleteButtons = document.querySelectorAll('.delete-icon');
    deleteButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            const propertyId = this.dataset.propertyId;
            const propertyTitle = this.dataset.propertyTitle;
            
            // Show confirmation modal
            currentDeleteProperty = {
                id: propertyId,
                title: propertyTitle
            };
            
            deletePropertyName.textContent = currentDeleteProperty.title;
            deleteModal.classList.add('active');
            confirmDeleteBtn.disabled = true;
            
            // Enable delete button after 2 seconds (safety measure)
            setTimeout(() => {
                confirmDeleteBtn.disabled = false;
            }, 2000);
        });
    });
});

// Close modal when clicking outside
deleteModal.addEventListener('click', (e) => {
    if (e.target === deleteModal) {
        deleteModal.classList.remove('active');
        currentDeleteProperty = null;
    }
});

        // Initialize progress bars
        document.querySelectorAll('.slots-progress-bar').forEach(bar => {
            const width = bar.dataset.width;
            bar.style.width = `${width}%`;
        });

        // Close modal when clicking outside
        deleteModal.addEventListener('click', (e) => {
            if (e.target === deleteModal) {
                deleteModal.classList.remove('active');
                currentDeleteProperty = null;
            }
        });

        // Favorite functionality (if user is tenant)
        document.querySelectorAll('.favorite-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                btn.classList.toggle('active');
            });
        });
    });
</script>
{% endblock %}